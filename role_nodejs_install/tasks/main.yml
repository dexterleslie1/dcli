# 参考
# https://blog.csdn.net/lisulong1/article/details/80167722

- name: "下载nodejs安装包"
  get_url:
   url: https://bucketxy.oss-cn-hangzhou.aliyuncs.com/nodejs/node-v15.14.0-linux-x64.tar.gz
   dest: /tmp/node-v15.14.0-linux-x64.tar.gz
   checksum: md5:66c4a66693a46df811602d37dff6b57b

- name: "解压nodejs安装包到/usr/local目录"
  shell: tar -xvzf /tmp/node-v15.14.0-linux-x64.tar.gz -C /usr/local

- name: "复制go.sh到/etc/profile.d/nodejs.sh"
  copy:
    src: nodejs.sh
    dest: /etc/profile.d/nodejs.sh
    force: yes

# ubuntu设置 /etc/sysctl.conf fs.inotify.max_user_watches = 5000000
# 否则报错: Error: ENOSPC: System limit for number of file watchers reached
# https://blog.csdn.net/lxyoucan/article/details/116736501
- name: "配置fs.inotify.max_user_watches = 5000000"
  lineinfile:
    path: /etc/sysctl.conf
    regexp: "^fs.inotify.max_user_watches"
    line: "fs.inotify.max_user_watches = 5000000"